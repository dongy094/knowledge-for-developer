# 인덱스(Index)

## 1. 인덱스(Index)란</br>
인덱스(Index)는 데이터베이스의 테이블에 대한 검색 속도를 향상시켜주는 자료구조이다.
`테이블의 특정 컬럼에 인덱스를 생성하면, 해당 컬럼의 데이터를 정렬한 후 별도의 메모리 공간에 데이터의 물리적 주소화 함께 저장된다.` 컬럼의 값과 물리적 주소를 [key,value]의 한 쌍으로 저장을 한다.

쉽게생각하면 인덱스를 책의 목차라고 생각하면 된다. 테이블에서 원하는 데이터를 찾기 위해 인덱스를 이용하면 원하는 데이터를 빠르게 찾을 수 있다.

<img src="https://github.com/dongy094/knowledge-for-developer/blob/main/DB/img/index_img.png?raw=true">

</br>
</br>

## 2. 인덱스(Index) 사용 이유</br>
데이터들이 정렬되어 있다는 점이다. 이 특징으로 인해 조건 검색이라는 영역에서 굉장한 장점이 된다.
</br>

#### `조건검색 Where 절의 효율성`
    테이블을 만들고 안에 데이터가 쌓이게 되면 테이블의 레코드는 내부적으로 순서가 없이 뒤죽박죽으로 저장된다.
    이렇게 되면 Where절에 특정 조건에 맞는 데이터들을 찾아낼때도 레코드의 처음부터 끝까지 다 읽어서 검색 조건과 맞는지
    비교해야 한다. 이것을 풀 테이블 스캔 (Full Table Scan)이라고 한다. 하지만 인덱스 테이블은 데이터들이 정렬되어
    저장되어 있기 때문에 해당 조건(Where)에 맞는 데이터들을 빠르게 찾아낼 수 있다.
    이것이 인덱스(Index)를 사용하는 가장 큰 이유이다.
</br>

#### `정렬 Order by 절의 효율성`
    인덱스(Index)를 사용하면 Order by에 의한 Sort과정을 피할 수 있다. Order by는 굉장히 부하가 많이 걸리는 작업이다.
    정렬과 동시에 1차적으로 메모리에서 정렬이 이루어지고 메모리보다 큰 작업이 필요하다면 디스크 I/O도 추가적으로 발생된다.
    하지만 인덱스를 사용하면 이러한 전반적인 자원의 소모를 하지 않아도 된다. 이미 정렬이 되어 있기 때문에
    가져오기만 하면 되니까 효율적이다.
</br>

#### `MIN, MAX의 효율적인 처리가 가능하다.`
    이것 또한 데이터가 정렬되어 있기에 얻을 수 있는 장점이다. MIN값과 MAX값을 레코드의 시작값과 끝 값 한건씩만
    가져오면 되기에 FULL TABE SCAN으로 테이블을 다 뒤져서 작업하는 것보다 훨씬 효율적으로 찾을 수 있다.
</br>

## 3. 인덱스(Index) 사용의 단점</br>
    인덱스의 가장 큰 문제점은 정렬된 상태를 계속 유지 시켜줘야 한다는 점이다. 그렇기에 레코드 내에 데이터값이 바뀌는 부분이라면
    악영향을 미친다. INSERT, UPDATE, DELETE를 통해 데이터가 추가되거나 값이 바뀐다면 INDEX 테이블 내에 있는 값들을
    다시 정렬해야된다. 그리고 INDEX 테이블, 원본 테이블 이렇게 두 군데에 데이터 수정 작업해줘야 한다는 단점도 있다.

    그리고 검색시에도 인덱스가 무조건 좋은 것이 아니다. 인덱스는 테이블의 전체 데이터 중에서 10~15% 이하의 데이터를
    처리하는 경우에만 효율적이고 그 이상의 데이터를 처리할 땐 인덱스를 사용하지 않는 것이 더 낫다. 그리고 인덱스를
    관리하기 위해서는 데이터베이스의 약 10%에 해당하는 저장공간이 추가로 필요하다.  
</br>

## 4. 인덱스 생성 전략</br>
    생성된 인덱스를 가장 효율적으로 사용하려면 데이터의 분포도는 최대한으로 그리고 조건절에 호출 빈도는 자주 사용되는 컬럼을
    인덱스로 생성하는 것이 좋다. 인덱스는 특정 컬럼을 기준으로 생성하고 기준이 된 컬럼으로 정렬된 Index 테이블이 생성된다.
    이 기준 컬럼은 최대한 중복이 되지 않는 값이 좋다. 가장 최선은 PK로 인덱스를 거는것이다. 중복된 값이 없는 인덱스 테이블이
    최적의 효율을 발생시키겠고 반대로 모든 값이 같은 컬럼이 인덱스 컬럼이 된다면 인덱스로써의 가치가 없다고 봐야 할 것이다.

1. 조건절에 자주 등장하는 컬럼
2. 항상 = 으로 비교되는 컬럼
3. 중복되는 데이터가 최소한인 컬럼 (분포도가 좋은) 컬럼
4. ORDER BY 절에서 자주 사용되는 컬럼
5. 조인 조건으로 자주 사용되는 컬럼

</br>

## 5. 인덱스의 자료구조</br>
    인덱스는 여러 자료구조를 이용해서 구현할 수 있는데, 대표적으로 해시 테이블(Hash Table)과 B+Tree가 있다.
    그 중에서도 가장 많이 사용하는 인덱스의 구조는 밸런스드 트리 인덱스 구조입니다. 그리고 B TREE 인덱스 중에서도 가장 많이
    사용하는것은 B*TREE 와 B+TREE 구조를 가장 많이 사용되는 인덱스의 구조입니다.
